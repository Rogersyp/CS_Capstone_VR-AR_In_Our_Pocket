<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>A-Frame - Room 4</title>
		<meta name="description" content="Room 4">
		<!-- Production Version, Minified -->
		<script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
		<!-- Development Version, Uncompressed with Source Maps 
		<script src="https://aframe.io/releases/0.5.0/aframe.js"></script>-->
	</head>

	<body>
		<a-scene id="scene" stats fog="type: linear; density: 1; far : 50; color: #AAA">
		
		<a-assets>
			<img id="sky" src="textures/sky.jpg">
			<img id="ground" src="textures/leaves_ground.jpg">
			<a-asset-item id="tree-obj" src="objects/tree.obj"></a-asset-item>
			<a-asset-item id="tree-mtl" src="objects/tree.mtl"></a-asset-item>
		</a-assets>

		<a-entity position="0 1.8 6">
			<a-camera>
				<a-cursor color="#4CC3D9"></a-cursor>
			</a-camera>
		</a-entity>

		<a-sky height="2048" radius="30" src="#sky" theta-length="90" width="2048"></a-sky>

		<a-entity
			geometry="primitive: plane; width: 60; height: 60;"
			material="color:#c0c0c0; flatShading: true; shader: standard; side: front; src: #ground; repeat: 100 100" rotation="-90 0 0">
		</a-entity>

		<a-entity
			geometry="primitive:torusKnot;p:7;q:2;radius:2;segmentsRadial:8" 
			material="color:#8080FF" position="0 13 0" scale="2 2 2">
			<a-animation dur="10000" attribute="geometry.q" to="7"></a-animation>
			<a-animation delay="10000" dur="10000" attribute="geometry.p" to="2"></a-animation>
		</a-entity>


		<a-entity id="player" collider-check>
  		<a-entity raycaster="objects: .collidable" position="0 -0.9 0" rotation="90 0 0"></a-entity>
		</a-entity>
		<a-entity class="collidable" geometry="primitive: box" position="1 0 0"></a-entity>



		</a-scene>
		<script>

			/*AFRAME.registerComponent('collider-check', {
			  dependencies: ['raycaster'],
			  init: function () {
			    this.el.addEventListener('raycaster-intersected', function () {
			      console.log('Player hit something!');
			    });
			  }
			});
			*/


			var sceneEl = document.querySelector('a-scene');
			
			if (sceneEl.hasLoaded) {
				addElements();
			} else {
				sceneEl.addEventListener('loaded', addElements);
			}
			
			function generateRand(min, max) {
				return Math.floor(Math.random() * (max - min) + min);
			}
			
			function addElements () {
				for (i = 0; i < 50; i++) { 
					var entityEl = document.createElement('a-entity');
					entityEl.setAttribute('obj-model', {
						obj: '#tree-obj',
						mtl: '#tree-mtl'
					});
					entityEl.setAttribute('scale', {
						x: 2,
						y: 2,
						z: 2
					});
					entityEl.setAttribute('position', {
						x: generateRand(-28,28),
						y: 3.8,
						z: generateRand(-28,28)
					});
                                        
                    //entityEl.setAttribute('light', {
                     	//type: 'point',
                        //color: '#424242',
                       // intensity: .1                                       
                	//});
                                         
					sceneEl.appendChild(entityEl);
				}
				
			};
		</script>
	</body>
</html>